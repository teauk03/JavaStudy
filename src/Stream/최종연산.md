# 스트림의 최종 연산

---

* 스트림을 소비하여 결과를 생성하는 연산을 의미함
* 최종 연산이 호출되면 소비된 스트림은 더 이상 사용할 수 없고 스트림 파이프라인이 종료됨
* 중간 연산과는 다르게 호출 시 바로 실행됨

<br></br>

## 종류

---
### **0. forEach**
```java
void forEach(Consumer<? super T> action);
```
* 스트림을 요소를 소모하는 최종 연산자
* 컬렉션이나 스트림의 요소에 특정 작업을 수행함
* 내부적으로 반복을 수행함
* 반환타입이 `void` 이므로 요소들을 출력하는 용도로 많이 사용함

<br></br>

### **1. 조건 검사**

| 메서드            | 메서드 선언부                                             | 설명                                               | 반환값     |
|-------------------|-----------------------------------------------------|--------------------------------------------------|------------|
| `allMatch()`      | `boolean allMatch(Predicate<? super T> predicate)`  | 스트림의 **모든 요소**가 주어진 조건을 만족하는지 확인. `(AND 연산자)`     | `boolean`  |
| `anyMatch()`      | `boolean anyMatch(Predicate<? super T> predicate)`  | 스트림의 **적어도 하나의 요소**가 주어진 조건을 만족하는지 확인. `(OR 연산자)`  | `boolean`  |
| `noneMatch()`     | `boolean noneMatch(Predicate<? super T> predicate)` | 스트림의 **모든 요소가** 주어진 조건을 만족하지 않는지 확인.             | `boolean`  |
| `findFirst()`     | `Optional<T> findFirst()`                           | 스트림의 **첫 번째 요소**를 반환.                            | `Optional` |
| `findAny()`       | `Optional<T> findAny()`                             | 스트림에서 **아무 요소나 하나**를 반환 (병렬 스트림에서 결과가 달라질 수 있음). | `Optional` |

<br></br>

---

### **2. 통계**

| 메서드            | 메서드 선언부                                             | 설명                                                                                       | 반환값         |
|-------------------|-----------------------------------------------------|------------------------------------------------------------------------------------------|----------------|
| `count()`         | `long count()`                                      | 스트림의 **요소 개수**를 반환.                                                            | `long`         |
| `max()`           | `Optional<T> max(Comparator<? super T> comparator)` | 스트림의 요소 중 **최대값**을 반환.                                                       | `Optional<T>`  |
| `min()`           | `Optional<T> min(Comparator<? super T> comparator)` | 스트림의 요소 중 **최소값**을 반환.                                                       | `Optional<T>`  |

<br></br>

---

### **3. 리듀싱 (Reducing)**
* 스트림의 요소를 줄여가며 연산을 수행하고 누적하는 작업을 반복하여 최종 값을 반환함

| 메서드            | 메서드 선언부                                               | 설명                                                                            | 반환값         |
|-------------------|-------------------------------------------------------|-------------------------------------------------------------------------------|----------------|
| `reduce()`        | `Optional<T> reduce(BinaryOperator<T> accumulator)`   | 스트림의 요소를 **하나의 값으로 누적** .                                    | `Optional<T>`  |
| `reduce()`        | `T reduce(T identity, BinaryOperator<T> accumulator)` | 초기값(`identity`)과 함께 스트림의 요소를 **누적**.                             | `T`            |

```java
List<Integer> numbers = Arrays.asList(1, 2, 3, 4, 5);

        // 초기값 없는 reduce()
        Optional<Integer> sum = numbers.stream()
                                       .reduce((a, b) -> a + b);
                                        // a = 누적 값, b = 스트림의 요소
                                        // 첫 번째 요소가 누적값으로 사용되고, 두 번째 요소부터는 누적값과 다음 요소가 연산됨
                                        // 1(a) + 2(b) = 3(a)
                                        // 3(a) + 3(b) = 6(a)
                                        // 6(a) + 4(b) = 10(a)
                                        // 10(a) + 5(b) = 15(최종 결과)
        sum.ifPresent(System.out::println); // 최종 결과인 15 출력

        // 초기값 있는 reduce()
        int sumWithInitialValue = numbers.stream()
                                       .reduce(0, (a, b) -> a + b);
                                        // a = 누적 값, b = 스트림의 요소
                                        // 초기값 0을 제공하고 연산을 시작
                                        // 0(a) + 1(b) = 1(a)
                                        // 1(a) + 2(b) = 3(a)
                                        // 3(a) + 3(b) = 6(a)
                                        // 6(a) + 4(b) = 10(a)
                                        // 10(a) + 5(b) = 15(최종 결과)
        System.out.println(sumWithInitialValue); // 최종 결과인 15 출력
```

| 특성                       | 초기값 없는 `reduce()`                | 초기값 있는 `reduce()`              |
|----------------------------|--------------------------------------|------------------------------------|
| **반환 타입**               | `Optional<T>`                        | 기본 타입  또는 `T` |
| **스트림 비어 있을 때**      | `Optional.empty()`               | 제공된 초기값                      |
| **값이 없는 경우 처리**      | `ifPresent()` 등으로 값의 존재 여부를 확인   | 값이 없더라도 초기값을 반환하므로 처리 필요 없음 |
| **빈 스트림 처리**           | `Optional.empty()`로 반환되어 안전하게 처리 | 기본값이 반환되므로 값이 항상 존재          |
| **사용하는 메서드**          | `ifPresent()`, `orElse()`, `orElseGet()` 등 | `get()` (값이 항상 존재하므로 바로 사용 가능) |

<br></br>

---

### **4. 수집 (Collecting)**

| 메서드            | 메서드 선언부                                                  | 설명                                                                                       | 반환값         |
|-------------------|----------------------------------------------------------|------------------------------------------------------------------------------------------|----------------|
| `collect()`       | `<R, A> R collect(Collector<? super T, A, R> collector)` | 스트림의 요소를 **컬렉션(List, Set 등) 또는 다른 형태로 변환**.                            | `R`            |

<br></br>

---

### **5. 스트림을 컬렉션과 배열로 변환**

| 메서드            | 메서드 선언부                                                                                                                                | 설명                                                                                       | 반환값         |
|-------------------|----------------------------------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|----------------|
| `toArray()`       | `Object[] toArray()`                                                                                                                   | 스트림의 요소를 **배열로 변환**.                                                          | `Object[]`     |
| `toArray()`       | `<A> A[] toArray(IntFunction<A[]> generator)`                                                                                          | 스트림의 요소를 **특정 타입의 배열로 변환**.                                              | `A[]`          |
| `toList()`        | `Collector<T, ?, List<T>> toList()`                                                                                                    | 스트림의 요소를 **리스트(List)**로 변환.                                                  | `List<T>`      |
| `toSet()`         | `Collector<T, ?, Set<T>> toSet()`                                                                                                      | 스트림의 요소를 **집합(Set)**으로 변환.                                                   | `Set<T>`       |
| `toCollection()`  | `<C extends Collection<T>> Collector<T, ?, C> toCollection(Supplier<C> collectionFactory)`                                             | 특정 **컬렉션 타입**으로 변환.                                                             | `C`            |
| `toMap()`         | `<T, K, U> Collector<T, ?, Map<K, U>> toMap(Function<? super T, ? extends K> keyMapper, Function<? super T, ? extends U> valueMapper)` | 스트림의 요소를 **키-값(Map)** 형태로 변환.                                               | `Map<K, U>`    |
`<A> A[] toArray(IntFunction<A[]> generator)` | 스트림의 요소를 **특정 타입의 배열로 변환**.                                                                                                            | `A[]`          |

<br></br>

---

### **6. 문자열 결합**

| 메서드            | 메서드 선언부                                                                                                        | 설명                                                                                       | 반환값         |
|-------------------|----------------------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|----------------|
| `joining()`       | `Collector<CharSequence, ?, String> joining()`                                                                 | 스트림의 **문자열 요소를 결합**.                                                         | `String`       |
| `joining()`       | `Collector<CharSequence, ?, String> joining(CharSequence delimiter)`                                           | **구분자**를 사용해 스트림의 문자열 요소를 결합.                                          | `String`       |
| `joining()`       | `Collector<CharSequence, ?, String> joining(CharSequence delimiter, CharSequence prefix, CharSequence suffix)` | **구분자, 접두사, 접미사**를 포함하여 문자열 요소 결합.                                    | `String`       |

<br></br>

---

### **7. 그룹화**

| 메서드            | 메서드 선언부                                                                                           | 설명                                                                                       | 반환값         |
|-------------------|---------------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|----------------|
| `groupingBy()`    | `<T, K> Collector<T, ?, Map<K, List<T>>> groupingBy(Function<? super T, ? extends K> classifier)` | 요소를 **특정 키**에 따라 그룹화.                                                         | `Map<K, List<T>>` |

<br></br>

---

### **8. 분할**

| 메서드            | 메서드 선언부                                                                                     | 설명                                                                                       | 반환값         |
|-------------------|---------------------------------------------------------------------------------------------|------------------------------------------------------------------------------------------|----------------|
| `partitioningBy()`| `<T> Collector<T, ?, Map<Boolean, List<T>>> partitioningBy(Predicate<? super T> predicate)` | 요소를 **조건**에 따라 두 그룹(true/false)으로 분할.                                       | `Map<Boolean, List<T>>` |


